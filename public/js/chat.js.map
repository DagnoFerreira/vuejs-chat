{"version":3,"sources":["chat.js"],"names":[],"mappings":"AAAA;;AAEA,OAAO,CAAC,OAAD,EAAU,kBAAV,EAA8B,UAA9B,CAAP,EAAkD,YAAY;;AAE5D,MAAM,MAAM,QAAQ,OAAR,CAAZ;AAAA,MACE,SAAS,QAAQ,UAAR,CADX;AAAA,MAEE,KAAK,QAAQ,kBAAR,CAFP;;AAIA;AACA,MAAM,SAAS,IAAf;AACA,MAAI,YAAY,IAAhB;;AAEA,WAAS,UAAT,CAAqB,KAArB,EAA4B;AAC1B;AACA,WAAO,KAAP;AACA;AACD;;AAED;AACA,MAAI,OAAO;AACT,cAAU,EADD;AAET,WAAO,EAFE;AAGT,cAAU,EAHD;AAIT,aAAS;AAJA,GAAX;;AAOA,WAAS,OAAT,CAAiB,IAAjB,EAAuB;AACrB,SAAK,KAAL,CAAW,IAAX,CAAgB,IAAhB;AACD;;AAED,WAAS,UAAT,CAAoB,OAApB,EAA6B;AAC3B,SAAK,QAAL,CAAc,IAAd,CAAmB,OAAnB;AACD;;AAED,MAAI,MAAJ,CAAW,mBAAX,EAAgC,UAAC,KAAD,EAAW;AACzC,WAAO,OAAO,KAAP,EAAc,MAAd,CAAqB,QAArB,CAAP;AACD,GAFD;;AAIA,WAAS,sBAAT,CAAgC,cAAhC,EAAgD,KAAhD,EAAuD;AACrD,QAAI,kBAAkB,KAAK,QAAL,CAAc,QAAQ,CAAtB,CAAtB;AACA,QAAI,CAAC,eAAL,EAAsB,OAAO,IAAP;AACtB,WAAO,gBAAgB,QAAhB,KAA6B,eAAe,QAAnD;AACD;;AAED,MAAI,MAAJ,CAAW,wBAAX,EAAqC,sBAArC;;AAEA,MAAI,MAAJ,CAAW,iBAAX,EAA8B,UAAC,cAAD,EAAiB,KAAjB,EAA2B;AACvD,QAAI,uBAAuB,cAAvB,EAAuC,KAAvC,KAAiD,UAAU,CAA/D,EAAkE;AAChE,aAAO,qBAAP;AACD,KAFD,MAEO;AACL,aAAO,EAAP;AACD;AACF,GAND;;AAQA,MAAI,UAAJ,CAAe,cAAf,EAA+B;AAC7B,SAAK,KADwB;AAE7B,WAAO,eAAU,EAAV,EAAc,IAAd,EAAoB;AACzB,UAAI,cAAc,SAAS,cAAT,CAAwB,cAAxB,CAAlB;AACA,kBAAY,SAAZ,GAAwB,YAAY,YAApC;AACA;AACD;;AAN4B,GAA/B;;AAUA,MAAI,WAAW,SAAS,MAAT,CAAgB,KAAK,KAAL,CAAY,KAAK,MAAL,KAAgB,GAAjB,GAAwB,CAAnC,CAAhB,CAAf;AAAA,MACE,SAAS,yFADX;;AAIA,MAAI,GAAJ,CAAQ;AACN,QAAI,OADE;AAEN,UAAM,IAFA;AAGN,aAAS;AACP,qBAAe,uBAAU,IAAV,EAAgB;AAC7B,aAAK,OAAL,GAAe,IAAf;AACD,OAHM;AAIP,gBAJO,wBAIM;AACX,YAAI,WAAW,WAAW,KAAK,QAAhB,CAAf;AACA,YAAI,YAAY,SAAhB,EAA2B;AACzB,eAAK,QAAL,GAAgB,EAAhB;AACA,cAAI,UAAU;AACZ,8BADY;AAEZ,qBAAS,QAFG;AAGZ,kBAAM,KAAK,GAAL,EAHM;AAIZ;AAJY,WAAd;AAMA,qBAAW,OAAX;AACA,iBAAO,IAAP,CAAY,wBAAZ,EAAsC,OAAtC;AACD;AACF;AAjBM;AAHH,GAAR;;AAwBA;AACA,GAAC,YAAW;AACV,QAAI,OAAO;AACT,wBADS;AAET;AAFS,KAAX;AAIA,WAAO,IAAP,CAAY,0BAAZ,EAAwC,IAAxC;AACA,YAAQ,IAAR;AACD,GAPD;;AASA,SAAO,EAAP,CAAU,0BAAV,EAAsC,UAAC,GAAD,EAAS;AAC7C,YAAQ,GAAR;AACD,GAFD;;AAIA,SAAO,EAAP,CAAU,wBAAV,EAAoC,UAAC,OAAD,EAAa;AAC/C,eAAW,OAAX;AACD,GAFD;AAID,CA5GD","file":"chat.js","sourcesContent":["'use strict';\n\ndefine(['vuejs', 'socket.io-client', 'momentjs'], function () {\n\n  const Vue = require('vuejs'),\n    moment = require('momentjs'),\n    io = require('socket.io-client');\n\n  // SocketIO setup\n  const socket = io();\n  var connected = true;\n\n  function cleanInput (input) {\n    // todo: make this work\n    return input;\n    //return $('<div/>').text(input).text();\n  }\n\n  // Vue\n  var data = {\n    messages: [],\n    users: [],\n    chatText: '',\n    channel: 'public'\n  };\n\n  function addUser(user) {\n    data.users.push(user);\n  }\n\n  function addMessage(message) {\n    data.messages.push(message);\n  }\n\n  Vue.filter('formatMessageDate', (value) => {\n    return moment(value).format('h:mm A');\n  });\n\n  function isNotSubsequentMessage(currentMessage, index) {\n    let previousMessage = data.messages[index - 1];\n    if (!previousMessage) return true;\n    return previousMessage.username !== currentMessage.username;\n  }\n\n  Vue.filter('isNotSubsequentMessage', isNotSubsequentMessage);\n\n  Vue.filter('getMessageClass', (currentMessage, index) => {\n    if (isNotSubsequentMessage(currentMessage, index) && index !== 0) {\n      return 'message-top-padding';\n    } else {\n      return '';\n    }\n  });\n\n  Vue.transition('messageAdded', {\n    css: false,\n    enter: function (el, done) {\n      var messageList = document.getElementById('message-list');\n      messageList.scrollTop = messageList.scrollHeight;\n      done();\n    },\n\n  });\n\n  let username = 'george'.concat(Math.floor((Math.random() * 100) + 1)),\n    avatar = 'http://www.picgifs.com/avatars/celebrities/nicolas-cage/avatars-nicolas-cage-621219.jpg'\n    ;\n\n  new Vue({\n    el: '#chat',\n    data: data,\n    methods: {\n      changeChannel: function (user) {\n        this.channel = user;\n      },\n      submitChat() {\n        var chatText = cleanInput(this.chatText);\n        if (chatText && connected) {\n          this.chatText = '';\n          let message = {\n            username,\n            message: chatText,\n            date: Date.now(),\n            avatar\n          };\n          addMessage(message);\n          socket.emit('chatTextClientToServer', message);\n        }\n      }\n    }\n  });\n\n  // Add this user on page load\n  (function() {\n    let user = {\n      username,\n      avatar\n    };\n    socket.emit('userJoinedClientToServer', user);\n    addUser(user);\n  })();\n\n  socket.on('userJoinedServerToClient', (obj) => {\n    addUser(obj);\n  });\n\n  socket.on('chatTextServerToClient', (message) => {\n    addMessage(message);\n  });\n\n});\n"],"sourceRoot":"/source/"}